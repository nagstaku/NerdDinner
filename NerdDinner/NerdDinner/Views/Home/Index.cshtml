@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <h1>Welcome to Nerd Dinner!</h1>
    <p class="lead">
        This project is a re-write of the popular Nerd Dinner MVC application using MVC 5 and Entity Framework 6. It is primarily
        a portfolio project for myself but feel free to download and fork it on GitHub!
    </p>
    <p><a href="http://asp.net" class="btn btn-primary btn-large">GitHub &raquo;</a></p>
</div>

<div class="row">
    <div class="col-md-5">
        <h2>Upcoming Events:</h2>
        @{int count = 0;}
            @{foreach (var dinner in ViewData["PopularDinners"]
            as IQueryable<NerdDinner.Models.Meeting>)
              {
    <div class="panel @ViewBag.ColorPicker[count]">
      <div class="panel-heading">
        <h3 class="panel-title">@dinner.Title</h3>
      </div>
      <div class="panel-body">
        @dinner.Description <input type="hidden" value="@dinner.Location.Zip" id="address-@count" />
          <span class="glyphicon glyphicon-map-marker pull-right" style="font-size:larger"></span>
      </div>

    </div>
                  count++;
                }}
    </div>
    <div class="col-md-7 well">
        <div id="map-canvas" style="height: 447px; max-width: none;"></div>
    </div>
</div>
<br />

@Html.ActionLink("Meetings", "Index", "Meeting")

@section Scripts {
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script>
        var map;
        var geocoder;
        var marker = new google.maps.Marker();
        var test = new google.maps.LatLng(37, -95);
        function initialize() {
            geocoder = new google.maps.Geocoder();
            var mapOptions = {
                center: new google.maps.LatLng(37.09024, -96.712891),
                zoom: 4
            };
            map = new google.maps.Map(document.getElementById("map-canvas"),
                mapOptions);

            geocoder.geocode({ 
                'address': document.getElementById('address-0').value,
                'address': document.getElementById('address-1').value,
                'address': document.getElementById('address-2').value
            }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    var markerRed = new google.maps.Marker({
                        position: results[0].geometry.location,
                        map: map,
                        infowindow: 'test'
                    });
                    var markerGreen = new google.maps.Marker({
                        position: new google.maps.LatLng(35.09024, -95.712891),
                        map: map,
                        icon: 'http://maps.gstatic.com/mapfiles/markers2/icon_green.png'
                    });
                    var markerBlue = new google.maps.Marker({
                        position: new google.maps.LatLng(37.09024, -96.712891),
                        map: map,
                        icon: 'http://maps.gstatic.com/mapfiles/markers2/boost-marker-mapview.png'
                    });
                } else {
                    alert("City and State not recognized. Error:" + status);
                }
            })
        }
        google.maps.event.addDomListener(window, 'load', initialize);

        function codeAddress() {
            var address = document.getElementById('City').value + ', OR';
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                } else {
                    alert("City and State not recognized. Error:" + status);
                }
            })
        }

        $(function () {
            $('#City').blur(function () {
                codeAddress();
            })
        })
    </script>
    }

